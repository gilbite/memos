## resource

http://ec.nikkeibp.co.jp/item/books/P98480.html

## memo

### 第1部 基礎

* アーキテクチャとは、から断固避けるべき問題(BBM)、原則/パターン集、テスティングに至る、開発の多くの部分をカバーしてる。
* それぞれの主題が適度にそしてコンパクトにまとまっている。(逆に言えば深掘り出来るわけではない。)
* が、(おそらく筆者の)体験ベースで話が進んでいる所が多く、説得力高い。
* 良書の期待を抱かせる導入部。

### 第2部 アーキテクチャの考案

* 5章は、DDD のエッセンスとしてコンテキスト(とコンテキスト間の関係)やユビキタス言語を紹介。また階層化アーキテクチャもわりと詳しく解説。そんなに量も多くないので、一旦ここ読んでからEvans本に取り組むのも有りな気がする。
* 6章は、レイヤードアーキテクチャにおけるプレゼンテーション層の解説。まるっと章をさいているところに、筆者の主張が感じられる。**UXファースト** と呼ぶアプローチで、モデリングから取り組むよりも先にUXを整えることでモデルが洗練されていくよね、って理解。なるほど。後半 .NET 関連の実例がおおくちょっとなえる。
* 7章は、いわゆる「ビジネスロジック」をどう作り上げていくのか、的な話。ドメインモデルパターンの解説にに多くを割く
  * トランザクションスクリプトもアンチパターンという感じで紹介しているわけではなくて、使いドコロを間違えるなよーという感じで紹介されてる。一貫してアーキテクト寄りの視点を崩さない感じ好き。
  * ドメインモデル貧血症についても、基本的にはアンチパターンの姿勢を貫きながら、ある程度考慮を促している。
  * 各レイヤーの境界で、ドメインモデルをそのまま使うという手を残しながら、最良のソリューションは DTO であろう、との言及。PHPでやるとしたらリフレクション使うのかなぁ。それともドメインオブジェクトに printer メソッド用意させたりするのかしら。何れにしてもクラスはたくさんできそう。どうしたもんか。

### 第3部 サポートアーキテクチャ

* 8章は、(ドメイン)モデルとは的な話から始まり、DDDの戦術的な話、Evans本にはない DomainEvent、その他割りと実装よりの話までたくさん。
  * メルカトル図法の話はココでも出てきて、良いたとえなのだろうなぁ。
  * なんだけど、`基本的なビジネスコンセプトを忠実に表現する`が出てきて、なんか「モデル」を磨き(作り)上げようてやろう的な雰囲気が読み取れない(2つのドメインモデル)
  * `アプリケーションは永続化に配慮すべきである`。DDD では、永続化のことを何も考えるなと言っているわけではないよ、という指摘。
  * `〜は、ここまでの内容からすれば正しいといえます。本章を読み終える頃には、あなたの視野が広がり、これが正しいとは言えなくなります。` かっけぇ。使ってこう。
  * 集約周りわかったようでよくわからん感じ。
  * Repository はドメインサービス。定義から言ってそりゃそうだ感。
  * Evans本にはない、ドメインイベントの導入。
* 9章は、いよいよドメインモデルパターンの開発ストーリーへ。
  * 境界づけられたコンテキスト発見から、エンティティや集約、ファクトリや値オブジェクト、永続化などを交えて、アプリケーションサービスまで形を示しつつ、作り上げていく。
  * ここで `永続化に対する譲歩` という見出しで、そこそこ分量を持って紹介されている。中身は .NET ライブラリとの折り合いの付け方、という言い方もできるかもしれないが、他の言語でもそれなり通用する内容に思える。
  * 原則やプラクティスにがっつり固執して身動き取れ無くなっちゃう前に、ある種の諦めというか制約と割りきってやってこう、という感じ。個人的には度々陥る罠。こういう実際に破綻しちゃう前にしっかりエクスキューズくれる感じなるほど実践編。
* 10章は、話が変わって CQRS の紹介。ものすごい勢いでオススメしてくる。複雑性のオーダーは N^2 から N になるとのこと。
  * `読み取り` と `書き込み` を分離する、という明確なコンセプトは、おそらく間違ってはいないのだろう。例えば http の GET や POST(/PUT/DELETE,,) で冪等性のあるリクエストかどうかをわけて、キャッシングなどで有利なように。
  * だが、そのためにコマンドとクエリにおいて2つのドメインモデルを作ることになる? のがいまいち解せん。後者はもはやモデルでもないような気がする。実際、後者はかなり薄く作れ的なことは書いてあるようだ。
  * 参照/更新を一つのモデルでは表しきれない、的な話はまぁ一定あるなー、という気もする。
  * この際、ドメインイベントを用いた別立てクエリ用ストレージを"結果整合性"のキーワードと共に紹介しており、イベントソーシングへの含みをもたせている。
  * この辺りは、実際のところ、いわゆるマイクロサービスやなんかの今のはやり(なのか本質なのか)の流れなんだろうなー。まだいまいち、ピンときてないところに頭の硬さが伺える2016年夏。
  * ご多分に漏れず、ここでも「全ての問題に適しているわけではない」的なエクスキューズはあるものの、あまりの熱量の高さに霞んで見えちゃう。
  * あってるかどうかわからない産業
    * 読み取り時のことまで考えるの色々面倒なんで
    * こっちで状態変更あったらイベント発火しとくので
    * あとはよしなにやって(読み取り系だろうが強調機能だろうが)
 
